language: python
dist: xenial
python:
  - "3.6"
  - "3.7"
  - "3.8"
env:
  - DJANGO=22-sqlite
  - DJANGO=30-sqlite
  - DJANGO=master-sqlite
  - DJANGO=22-pg
  - DJANGO=30-pg
  - DJANGO=master-pg

addons:
  postgresql: "10"

matrix:
  fast_finish: true
  allow_failures:
    - env: DJANGO=master-sqlite
    - env: DJANGO=master-pg

install: pip install tox-travis codecov
before_script:
  - |
    if [[ -z $TOXENV ]]; then
      export TOXENV=py$(echo $TRAVIS_PYTHON_VERSION | sed -e 's/\.//g')-dj$DJANGO
    fi
  - echo $TOXENV
script: tox
after_success: codecov

jobs:
  include:
    - python: "3.7"
      env: TOXENV=docs
